{"appModel":"1.1.1","connections":{},"contrib":"W3sicmVmIjoiZ2l0LnRpYmNvLmNvbS9naXQvcHJvZHVjdC9pcGFhcy93aS1jb250cmliLmdpdC9jb250cmlidXRpb25zL0dlbmVyYWwiLCJzM2xvY2F0aW9uIjoiVGliY28vR2VuZXJhbCJ9XQ==","description":"","feVersion":"2.9.0","imports":["github.com/project-flogo/contrib/activity/actreturn","git.tibco.com/git/product/ipaas/wi-contrib.git/contributions/General/trigger/rest","github.com/project-flogo/contrib/function/string","git.tibco.com/git/product/ipaas/wi-contrib.git/contributions/General/activity/log","github.com/project-flogo/flow","github.com/project-flogo/flow/activity/subflow"],"name":"AirPipeline","properties":[{"name":"DataSource_Logging.LogLevel","type":"string","value":"DEBUG"},{"name":"DataSource_HTTPTrigger.Port","type":"float64","value":9999},{"name":"DataSource_App.ComponentName","type":"string","value":"DataSource"},{"name":"Filter_0_Filter.FlogoBooleanExpression","type":"string","value":" "},{"name":"Logging.LogLevel","type":"string","value":"DEBUG"},{"name":"Filter_0_App.ComponentName","type":"string","value":"Filter_0"},{"name":"Logging.LogLevel","type":"string","value":"INFO"},{"name":"Pipe_1_App.ComponentName","type":"string","value":"Pipe_1"}],"resources":[{"data":{"description":"","explicitReply":true,"links":[{"from":"Log","id":1,"to":"Next_Flow","type":"default"},{"from":"Next_Flow","id":2,"to":"Return","type":"default"}],"metadata":{"input":[{"name":"data","schema":{"type":"json","value":"{\"gateway\":{\"type\":\"string\"},\"readings\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"id\":{\"type\":\"string\"},\"origin\":{\"type\":\"number\"},\"device\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"},\"value\":{\"type\":\"string\"},\"valueType\":{\"type\":\"string\"}}}}}"},"type":"object"}],"output":[]},"name":"DataSource","tasks":[{"activity":{"input":{"Log Level":"=$property[\"DataSource_Logging.LogLevel\"]","flowInfo":false,"message":"=string.concat(\"########## DataSource ##########\", string.tostring($flow.data))"},"ref":"#log"},"description":"Simple Log Message Activity","id":"Log","name":"Log"},{"activity":{"input":{"enriched":{"mapping":[]},"gateway":"=$flow.data.gateway","reading":"=$iteration[value]"},"ref":"#subflow","schemas":{"input":{"input":{"type":"json","value":"{\"$schema\":\"http://json-schema.org/draft-04/schema#\",\"type\":\"object\",\"properties\":{\"gateway\":{\"type\":\"string\"},\"reading\":{\"type\":\"object\",\"properties\":{\"id\":{\"type\":\"string\"},\"origin\":{\"type\":\"number\"},\"device\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"},\"value\":{\"type\":\"string\"},\"valueType\":{\"type\":\"string\"},\"mediaType\":{\"type\":\"string\"}}},\"enriched\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"producer\":{\"type\":\"string\"},\"consumer\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"},\"value\":{\"type\":\"string\"},\"type\":{\"type\":\"string\"}}}}}}"}}},"settings":{"flowURI":"res://flow:Filter_0"}},"description":"Simple SubFlow Activity","id":"Next_Flow","name":"Next_Flow","settings":{"accumulate":false,"iterate":"=$flow.data.readings"},"type":"iterator"},{"activity":{"ref":"#actreturn"},"description":"Simple Return Activity","id":"Return","name":"Return"}]},"id":"flow:DataSource"},{"data":{"description":"","links":[{"from":"Log","id":1,"label":"LogMessagetoLogMessage1","to":"LogFiltered","type":"expression","value":"$property[\"Filter_0_Filter.FlogoBooleanExpression\"]"},{"from":"LogFiltered","id":2,"to":"Return01","type":"default"},{"from":"Log","id":3,"label":"LogMessage to LogMessage1","to":"LogSingleReading","type":"exprOtherwise"},{"from":"LogSingleReading","id":4,"to":"Next_Flow","type":"default"},{"from":"Next_Flow","id":5,"to":"Return02","type":"default"}],"metadata":{"input":[{"name":"gateway","type":"string"},{"name":"reading","schema":{"type":"json","value":"{\"id\":{\"type\":\"string\"},\"origin\":{\"type\":\"number\"},\"device\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"},\"value\":{\"type\":\"string\"},\"valueType\":{\"type\":\"string\"},\"mediaType\":{\"type\":\"string\"}}"},"type":"object"},{"name":"enriched","schema":{"type":"json","value":"{\"type\":\"object\",\"properties\":{\"producer\":{\"type\":\"string\"},\"consumer\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"},\"value\":{\"type\":\"string\"},\"type\":{\"type\":\"string\"}}}"},"type":"array"}],"output":[]},"name":"Filter_0","tasks":[{"activity":{"input":{"Log Level":"=$property[\"Logging.LogLevel\"]","flowInfo":false,"message":"=string.concat(\"########## Filter_0(Expression) ########## : gateway = \", $flow.gateway, \", reading = \", string.tostring($flow.reading), \", enriched = \", string.tostring($flow.enriched))"},"ref":"#log"},"description":"Simple Log Message Activity","id":"Log","name":"Log"},{"activity":{"input":{"Log Level":"=$property[\"Logging.LogLevel\"]","flowInfo":false,"message":"Message Filtered"},"ref":"#log"},"description":"Simple Log Message Activity","id":"LogFiltered","name":"LogFiltered"},{"activity":{"ref":"#actreturn"},"description":"Simple Return Activity","id":"Return01","name":"Return01"},{"activity":{"input":{"Log Level":"INFO","flowInfo":false,"message":"Processing single readings"},"ref":"#log"},"description":"Simple Log Message Activity","id":"LogSingleReading","name":"LogSingleReading"},{"activity":{"input":{"enriched":"=$flow.enriched","gateway":"=$flow.gateway","reading":"=$flow.reading"},"ref":"#subflow","schemas":{"input":{"input":{"type":"json","value":"{\"$schema\":\"http://json-schema.org/draft-04/schema#\",\"type\":\"object\",\"properties\":{\"gateway\":{\"type\":\"string\"},\"reading\":{\"type\":\"object\",\"properties\":{\"id\":{\"type\":\"string\"},\"origin\":{\"type\":\"number\"},\"device\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"},\"value\":{\"type\":\"string\"},\"valueType\":{\"type\":\"string\"},\"mediaType\":{\"type\":\"string\"}}},\"enriched\":{\"type\":\"array\",\"items\":{\"type\":\"object\",\"properties\":{\"producer\":{\"type\":\"string\"},\"consumer\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"},\"value\":{\"type\":\"string\"},\"type\":{\"type\":\"string\"}}}}}}"}}},"settings":{"flowURI":"res://flow:Pipe_1"}},"description":"Simple SubFlow Activity","id":"Next_Flow","name":"Next_Flow"},{"activity":{"ref":"#actreturn"},"description":"Simple Return Activity","id":"Return02","name":"Return02"}]},"id":"flow:Filter_0"},{"data":{"description":"","links":[{"from":"Log","id":1,"to":"Return","type":"default"}],"metadata":{"input":[{"name":"gateway","type":"string"},{"name":"reading","schema":{"type":"json","value":"{\"id\":{\"type\":\"string\"},\"origin\":{\"type\":\"number\"},\"device\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"},\"value\":{\"type\":\"string\"},\"valueType\":{\"type\":\"string\"},\"mediaType\":{\"type\":\"string\"}}"},"type":"object"},{"name":"enriched","schema":{"type":"json","value":"{\"type\":\"object\",\"properties\":{\"producer\":{\"type\":\"string\"},\"consumer\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"},\"value\":{\"type\":\"string\"},\"type\":{\"type\":\"string\"}}}"},"type":"array"}],"output":[]},"name":"Pipe_1","tasks":[{"activity":{"input":{"addDetails":false,"message":"########## Aggregate ##########"},"ref":"#log"},"description":"Logs a message","id":"Log","name":"Log"},{"activity":{"ref":"#actreturn"},"description":"Simple Return Activity","id":"Return","name":"Return"}]},"id":"flow:Pipe_1"}],"triggers":[{"description":"Simple REST Trigger","handlers":[{"action":{"input":{"data":"=$.body"},"ref":"github.com/project-flogo/flow","settings":{"flowURI":"res://flow:DataSource"}},"description":"","name":"DataSource","reply":{"code":200,"configureResponseCodes":false,"message":{}},"schemas":{"output":{"body":{"type":"json","value":"{\n            \"$schema\": \"http://json-schema.org/draft-04/schema#\",\n            \"type\": \"object\",\n            \"properties\": {\n                \"gateway\": {\n                    \"type\": \"string\"\n                },\n                \"readings\": {\n                    \"type\": \"array\",\n                    \"items\": {\n                        \"type\": \"object\",\n                        \"properties\": {\n                            \"id\": {\n                                \"type\": \"string\"\n                            },\n                            \"origin\": {\n                                \"type\": \"number\"\n                            },\n                            \"device\": {\n                                \"type\": \"string\"\n                            },\n                            \"name\": {\n                                \"type\": \"string\"\n                            },\n                            \"value\": {\n                                \"type\": \"string\"\n                            },\n                            \"valueType\": {\n                                \"type\": \"string\"\n                            },\n                            \"mediaType\": {\n                                \"type\": \"string\"\n                            }\n                        }\n                    }\n                }\n            }\n        }"},"headers":{"type":"json","value":"{\"type\":\"object\",\"properties\":{\"Accept\":{\"type\":\"string\",\"visible\":false},\"Accept-Charset\":{\"type\":\"string\",\"visible\":false},\"Accept-Encoding\":{\"type\":\"string\",\"visible\":false},\"Content-Type\":{\"type\":\"string\",\"visible\":false},\"Content-Length\":{\"type\":\"string\",\"visible\":false},\"Connection\":{\"type\":\"string\",\"visible\":false},\"Cookie\":{\"type\":\"string\",\"visible\":false},\"Pragma\":{\"type\":\"string\",\"visible\":false}},\"required\":[]}"}},"reply":{"responseBody":{"fe_metadata":"{\"type\":\"object\",\"properties\":{\"body\":{\"type\":\"any\"},\"headers\":{\"type\":\"object\"}}}","type":"json","value":"{\"type\":\"object\",\"properties\":{\"body\":{\"type\":\"any\"},\"headers\":{\"type\":\"object\"}}}"}}},"settings":{"Method":"POST","OutputValidation":false,"Path":"/f1/air/pipeline"}}],"id":"ReceiveHTTPMessage","name":"tibco-wi-rest","ref":"#rest","settings":{"APISpecUpdate":false,"caCertificate":"","port":"=$property[\"DataSource_HTTPTrigger.Port\"]","secureConnection":false,"serverKey":"","swagger":""}}],"type":"flogo:app","version":"1.0.0"}